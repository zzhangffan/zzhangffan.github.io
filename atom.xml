<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>张帆</title>
  
  <subtitle>做一件有价值的事，一直做，然后等待时间的回报。</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="zzhangffan.com/"/>
  <updated>2018-02-27T09:33:40.619Z</updated>
  <id>zzhangffan.com/</id>
  
  <author>
    <name>zhangfan</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>jdk及cglib代理</title>
    <link href="zzhangffan.com/20180227-proxy/"/>
    <id>zzhangffan.com/20180227-proxy/</id>
    <published>2018-02-27T06:03:00.000Z</published>
    <updated>2018-02-27T09:33:40.619Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>代理：为其他对象提供一种代理以控制对这个对象的访问。</p></blockquote><h2 id="静态代理"><a href="#静态代理" class="headerlink" title="静态代理"></a>静态代理</h2><p>程序运行前就已经存在的编译好的代理类</p><p>假设我们有一个Hello类，其中有一个sayHello的方法，输出一个字符串，代码如下：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Hello</span></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sayHello</span><span class="params">()</span></span>&#123;</span><br><span class="line">System.out.println(<span class="string">"hello!"</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>现在要在sayHello方法执行前后做些事情，比如各打印一句话，我们可以将上面的程序改成这样：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Hello</span></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sayHello</span><span class="params">()</span></span>&#123;</span><br><span class="line">System.out.println(<span class="string">"========== begin =========="</span>);</span><br><span class="line">System.out.println(<span class="string">"hello!"</span>);</span><br><span class="line">System.out.println(<span class="string">"========== end =========="</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>看似完成了效果，但是需要我们修改sayHello方法的代码，有没有办法不修改目标方法呢，我们可以创建一个代理类，如下：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloProxy</span></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> Hello hello;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">HelloProxy</span><span class="params">(Hello hello)</span></span>&#123;</span><br><span class="line"><span class="keyword">this</span>.hello = hello;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doProxy</span><span class="params">()</span></span>&#123;</span><br><span class="line">System.out.println(<span class="string">"========== begin =========="</span>);</span><br><span class="line">hello.sayHello();</span><br><span class="line">System.out.println(<span class="string">"========== end =========="</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String [] args)</span> </span>&#123;</span><br><span class="line">HelloProxy proxy = <span class="keyword">new</span> HelloProxy(<span class="keyword">new</span> Hello());</span><br><span class="line">proxy.doProxy();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>但是，如果我们有多个类要实现同样的代理任务，按这种方式我们需要为每个类相应的创建一个XXXProxy代理类，看起来有点傻，有没有其他办法呢？我们可以用JAVA的动态代理来实现：</p><h2 id="动态代理"><a href="#动态代理" class="headerlink" title="动态代理"></a>动态代理</h2><p>程序运行前并不存在代理类，无需手动编写代理类的源码，通过Java反射来生成</p><p><span class="note">Java动态代理需要代理类和目标类实现同一个接口：</span><br>定义一个目标接口：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">TargetInterface</span></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sayHello</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sayGoodbye</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>实现目标接口的委托类：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">targetImpl</span> <span class="keyword">implements</span> <span class="title">TargetInterface</span></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sayHello</span><span class="params">()</span></span>&#123;</span><br><span class="line">System.out.println(<span class="string">"========== hello =========="</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sayGoodbye</span><span class="params">()</span></span>&#123;</span><br><span class="line">System.out.println(<span class="string">"========== goodbye =========="</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>最后，代理处理类：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProxyHandler</span> <span class="keyword">implements</span> <span class="title">InvocationHandler</span></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> Object target;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ProxyHandler</span><span class="params">(Object target)</span></span>&#123;</span><br><span class="line"><span class="keyword">this</span>.target = target;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//实现了InvocationHandler接口，方法调用会被转发到这个方法</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;  </span><br><span class="line">          </span><br><span class="line">        System.out.println(<span class="string">"========== before =========="</span>);  </span><br><span class="line">        Object object = method.invoke(target, args);</span><br><span class="line">        System.out.println(<span class="string">"========== after =========="</span>);  </span><br><span class="line">        <span class="keyword">return</span> object;  </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//获取代理类，*关键</span></span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; <span class="function">T <span class="title">getProxy</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (T) Proxy.newProxyInstance(</span><br><span class="line">    target.getClass().getClassLoader(),<span class="comment">//代理对象的类加载器</span></span><br><span class="line">    target.getClass().getInterfaces(),<span class="comment">//代理对象要实现的接口</span></span><br><span class="line">    <span class="keyword">this</span>);<span class="comment">//实际处理程序</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String [] args)</span></span>&#123;</span><br><span class="line">    TargetInterface target = <span class="keyword">new</span> ProxyHandler(<span class="keyword">new</span> TargetImpl()).getProxy();</span><br><span class="line">    target.sayHello();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>反编译代理类后，如下：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> $<span class="title">proxy4</span></span></span><br><span class="line"><span class="class">  <span class="keyword">extends</span> <span class="title">Proxy</span></span></span><br><span class="line"><span class="class">  <span class="keyword">implements</span> <span class="title">TargetInterface</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> Method m3;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> Method m1;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> Method m0;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> Method m4;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> Method m2;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> $proxy4(InvocationHandler paramInvocationHandler)</span><br><span class="line">    <span class="keyword">throws</span> </span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">super</span>(paramInvocationHandler);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">sayHello</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    <span class="keyword">throws</span> </span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">this</span>.h.invoke(<span class="keyword">this</span>, m3, <span class="keyword">null</span>);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (Error|RuntimeException localError)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">throw</span> localError;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (Throwable localThrowable)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> UndeclaredThrowableException(localThrowable);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">sayGoodbye</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    <span class="keyword">throws</span> </span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">this</span>.h.invoke(<span class="keyword">this</span>, m4, <span class="keyword">null</span>);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (Error|RuntimeException localError)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">throw</span> localError;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (Throwable localThrowable)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> UndeclaredThrowableException(localThrowable);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//省略Object类的hashCode(),equals()以及toString()方法</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">static</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">      m3 = Class.forName(<span class="string">"com.TargetInterface"</span>).getMethod(<span class="string">"sayHello"</span>, <span class="keyword">new</span> Class[<span class="number">0</span>]);</span><br><span class="line">      m1 = Class.forName(<span class="string">"java.lang.Object"</span>).getMethod(<span class="string">"equals"</span>, <span class="keyword">new</span> Class[] &#123; Class.forName(<span class="string">"java.lang.Object"</span>) &#125;);</span><br><span class="line">      m0 = Class.forName(<span class="string">"java.lang.Object"</span>).getMethod(<span class="string">"hashCode"</span>, <span class="keyword">new</span> Class[<span class="number">0</span>]);</span><br><span class="line">      m4 = Class.forName(<span class="string">"com.TargetInterface"</span>).getMethod(<span class="string">"sayGoodbye"</span>, <span class="keyword">new</span> Class[<span class="number">0</span>]);</span><br><span class="line">      m2 = Class.forName(<span class="string">"java.lang.Object"</span>).getMethod(<span class="string">"toString"</span>, <span class="keyword">new</span> Class[<span class="number">0</span>]);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (NoSuchMethodException localNoSuchMethodException)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchMethodError(localNoSuchMethodException.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (ClassNotFoundException localClassNotFoundException)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> NoClassDefFoundError(localClassNotFoundException.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>前面我们说过Java原生动态代理需要代理类和委托类实现同一接口，那如果是没有接口的类呢？我们可以使用开源的CGLib：<br>用我们之前定义的Hello类，他没有实现任何接口，如下：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Hello</span></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sayHello</span><span class="params">()</span></span>&#123;</span><br><span class="line">System.out.println(<span class="string">"hello!"</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>代理处理类：</p><ul><li>实现MethodInterceptor，方法调用转发到intercept()方法<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProxyInterceptor</span> <span class="keyword">implements</span> <span class="title">MethodInterceptor</span></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">intercept</span><span class="params">(Object target, Method method, Object[] args, MethodProxy proxy)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"========== before =========="</span>);</span><br><span class="line">        Object object = proxy.invokeSuper(target,args);</span><br><span class="line">        System.out.println(<span class="string">"========== end =========="</span>);</span><br><span class="line">        <span class="keyword">return</span> object;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; <span class="function">T <span class="title">getProxy</span><span class="params">(Class&lt;T&gt; cls)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (T) Enhancer.create(cls,<span class="keyword">this</span>);<span class="comment">//1 父类 2实际处理</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ProxyInterceptor proxy = <span class="keyword">new</span> ProxyInterceptor();</span><br><span class="line">        TargetInterface target = proxy.getProxy(Hello.class);</span><br><span class="line">        target.sayHello();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><p>代理类具体实现（网络）：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloConcrete</span>$$<span class="title">EnhancerByCGLIB</span>$$<span class="title">e3734e52</span></span></span><br><span class="line"><span class="class">  <span class="keyword">extends</span> <span class="title">HelloConcrete</span></span></span><br><span class="line"><span class="class">  <span class="keyword">implements</span> <span class="title">Factory</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="keyword">private</span> MethodInterceptor CGLIB$CALLBACK_0; <span class="comment">// ~~</span></span><br><span class="line">  ...</span><br><span class="line">   </span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> String <span class="title">sayHello</span><span class="params">(String paramString)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">    MethodInterceptor tmp17_14 = CGLIB$CALLBACK_0;</span><br><span class="line">    <span class="keyword">if</span> (tmp17_14 != <span class="keyword">null</span>) &#123;</span><br><span class="line">      <span class="comment">// 将请求转发给MethodInterceptor.intercept()方法。</span></span><br><span class="line">      <span class="keyword">return</span> (String)tmp17_14.intercept(<span class="keyword">this</span>, </span><br><span class="line">              CGLIB$sayHello$<span class="number">0</span>$Method, </span><br><span class="line">              <span class="keyword">new</span> Object[] &#123; paramString &#125;, </span><br><span class="line">              CGLIB$sayHello$<span class="number">0</span>$Proxy);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">super</span>.sayHello(paramString);</span><br><span class="line">  &#125;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ul><li>使用jdk实现动态代理需要代理类和委托类实现同样的接口。</li><li>使用CGLib，用继承实现，不能对final修饰的类及方法使用</li></ul><h1 id="（完）"><a href="#（完）" class="headerlink" title="（完）"></a>（完）</h1>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;代理：为其他对象提供一种代理以控制对这个对象的访问。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;静态代理&quot;&gt;&lt;a href=&quot;#静态代理&quot; class=&quot;headerlink&quot; title=&quot;静态代理&quot;&gt;&lt;/a&gt;静态代理&lt;/h2&gt;&lt;p&gt;程
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Linux命令之ls</title>
    <link href="zzhangffan.com/20180111-linux-ls/"/>
    <id>zzhangffan.com/20180111-linux-ls/</id>
    <published>2018-01-11T02:19:41.000Z</published>
    <updated>2018-02-27T05:05:15.947Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>此为Linux命令使用系列记录，博主使用到了哪些命令就写了哪些，命令的参数也记录不全，用到的就写了，需要完整学习，请参考<a href="http://man.linuxde.net/" target="_blank" rel="noopener">Linux命令大全(手册)_Linux常用命令行实例详解_Linux命令学习手册</a>    </p></blockquote><h2 id="ls命令"><a href="#ls命令" class="headerlink" title="ls命令"></a><strong>ls命令</strong></h2><p>ls命令用来显示目标列表</p><h2 id="语法"><a href="#语法" class="headerlink" title="语法"></a><strong>语法</strong></h2><blockquote><p>ls  (选项)  (参数)</p></blockquote><h2 id="参数"><a href="#参数" class="headerlink" title="参数"></a><strong>参数</strong></h2><p>目录：指定要显示列表的目录，也可以是具体的文件。</p><h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a><strong>示例</strong></h2><ul><li><strong><em>列出当前目录下非隐藏文件及目录</em></strong><blockquote><p>[root@hostname ~]#  ls<br>&emsp;</p></blockquote></li></ul><p>&emsp;&emsp;<span style="color: red;">PS:我的root用户的home目录下没有非隐藏文件及目录，看看你的执行结果吧</span></p><ul><li><strong><em>列出当前目录下所有文件及目录</em></strong><blockquote><p>[root@hostname ~]#  ls  -a<br>.   .bash_history  .bash_profile  .cache  .npm  .pydistutils.cfg  .tcshrc<br>..  .bash_logout   .bashrc        .cshrc  .pip  .ssh</p></blockquote></li></ul><p>&emsp;&emsp;<span style="color: red;">PS:Linux中以.开头的为隐藏文件</span></p><ul><li><strong><em>以长格式列出当前目录下所有文件及目录</em></strong><blockquote><p>[root@hostname ~]# ls -a -l<br>total 60<br>dr-xr-x—.   6 root root  4096 Jan  1 09:57 .<br>dr-xr-xr-x.  18 root root  4096 Dec 31 14:45 ..<br>-rw——-    1 root root  1403 Jan 11 09:39 .bash_history<br>-rw-r–r–.   1 root root    18 Dec 29  2013 .bash_logout<br>-rw-r–r–.   1 root root   176 Dec 29  2013 .bash_profile<br>-rw-r–r–.   1 root root   176 Dec 29  2013 .bashrc<br>drwx——    3 root root  4096 Oct 15 23:24 .cache<br>-rw-r–r–.   1 root root   100 Dec 29  2013 .cshrc<br>drwxr-xr-x  237 base base 12288 Jan  1 09:58 .npm<br>drwxr-xr-x    2 root root  4096 Oct 15 23:24 .pip<br>-rw-r–r–    1 root root    64 Oct 15 23:24 .pydistutils.cfg<br>drwx——    2 root root  4096 Dec 31 14:45 .ssh<br>-rw-r–r–.   1 root root   129 Dec 29  2013 .tcshrc</p></blockquote></li></ul><p>&emsp;&emsp;<span style="color: red;">PS：<a href="/post_sources/linuxcommands/ls-result.xml">命令结果解析</a></span></p><ul><li><p><strong><em>按最近一次修改的时间排序显示</em></strong></p><blockquote><p>[root@hostname ~]#  ls  -t<br>.bash_history  .     ..    .pydistutils.cfg  .bash_logout   .bashrc  .tcshrc<br>.npm           .ssh  .pip  .cache            .bash_profile  .cshrc</p></blockquote></li><li><p><strong><em>指定目录显示</em></strong></p><blockquote><p>[root@hostname tmp]#  ls  test<br>son  test.txt</p></blockquote></li><li><p><strong><em>遍历目录显示</em></strong></p><blockquote><p>[root@hostname tmp]#  ls  test -R<br>test:<br>son  test.txt<br>&emsp;<br>test/son:<br>sontest.txt</p></blockquote></li></ul><h2 id="选项"><a href="#选项" class="headerlink" title="选项"></a><strong>选项</strong></h2><blockquote><p>-a：显示所有档案及目录（ls内定将档案名或目录名称为“.”的视为影藏，不会列出）；<br>-A：显示除影藏文件“.”和“..”以外的所有文件列表；<br>-C：多列显示输出结果。这是默认选项；<br>-l：与“-C”选项功能相反，所有输出信息用单列格式输出，不输出为多列；<br>-F：在每个输出项后追加文件的类型标识符，具体含义：“<em>”表示具有可执行权限的普通文件，“/”表示目录，“@”表示符号链接，“|”表示命令管道FIFO，“=”表示sockets套接字。当文件为普通文件时，不输出任何标识符；<br>-b：将文件中的不可输出的字符以反斜线“”加字符编码的方式输出；<br>-c：与“-lt”选项连用时，按照文件状态时间排序输出目录内容，排序的依据是文件的索引节点中的ctime字段。与“-l”选项连用时，则排序的一句是文件的状态改变时间；<br>-d：仅显示目录名，而不显示目录下的内容列表。显示符号链接文件本身，而不显示其所指向的目录列表；<br>-f：此参数的效果和同时指定“aU”参数相同，并关闭“lst”参数的效果；<br>-i：显示文件索引节点号（inode）。一个索引节点代表一个文件；<br>–file-type：与“-F”选项的功能相同，但是不显示“</em>”；<br>-k：以KB（千字节）为单位显示文件大小；<br>-l：以长格式显示目录下的内容列表。输出的信息从左到右依次包括文件名，文件类型、权限模式、硬连接数、所有者、组、文件大小和文件的最后修改时间等；<br>-m：用“,”号区隔每个文件和目录的名称；<br>-n：以用户识别码和群组识别码替代其名称；<br>-r：以文件名反序排列并输出目录内容列表；<br>-s：显示文件和目录的大小，以区块为单位；<br>-t：用文件和目录的更改时间排序；<br>-L：如果遇到性质为符号链接的文件或目录，直接列出该链接所指向的原始文件或目录；<br>-R：递归处理，将指定目录下的所有文件及子目录一并处理；<br>–full-time：列出完整的日期与时间；<br>–color[=WHEN]：使用不同的颜色高亮显示不同类型的。</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;此为Linux命令使用系列记录，博主使用到了哪些命令就写了哪些，命令的参数也记录不全，用到的就写了，需要完整学习，请参考&lt;a href=&quot;http://man.linuxde.net/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;
      
    
    </summary>
    
    
      <category term="Linux" scheme="zzhangffan.com/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>Hexo + GitHub Pages搭建个人博客</title>
    <link href="zzhangffan.com/20171231-hexo-github-pages/"/>
    <id>zzhangffan.com/20171231-hexo-github-pages/</id>
    <published>2017-12-31T03:39:56.000Z</published>
    <updated>2018-02-27T05:04:58.928Z</updated>
    
    <content type="html"><![CDATA[<blockquote><h2 id="准备工具"><a href="#准备工具" class="headerlink" title="准备工具"></a>准备工具</h2></blockquote><ul><li>Node.js（必须）用于支持Hexo，生成静态页面</li><li>Git（必须）用于推送本地内容</li><li>注册一个GitHib账号，存放文件，服务器</li></ul><blockquote><h2 id="搭建环境"><a href="#搭建环境" class="headerlink" title="搭建环境"></a>搭建环境</h2></blockquote><ul><li><h2 id="Node-js"><a href="#Node-js" class="headerlink" title="Node.js"></a><em>Node.js</em></h2><h1 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a><em>Windows</em></h1><p><a href="https://nodejs.org/en/download/" target="_blank" rel="noopener">官网</a>下载.msi文件到本地，双击安装即可</p><h1 id="Linux-CentOS"><a href="#Linux-CentOS" class="headerlink" title="Linux(CentOS)"></a><em>Linux(CentOS)</em></h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo yum install nodejs</span><br></pre></td></tr></table></figure></li><li><h2 id="Git"><a href="#Git" class="headerlink" title="Git"></a><em>Git</em></h2><h1 id="Windows-1"><a href="#Windows-1" class="headerlink" title="Windows"></a><em>Windows</em></h1><p><a href="https://git-scm.com/" target="_blank" rel="noopener">官网</a>下载安装软件包到本地，双击安装即可</p><h1 id="Linux-CentOS-1"><a href="#Linux-CentOS-1" class="headerlink" title="Linux(CentOS)"></a><em>Linux(CentOS)</em></h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ yum install git</span><br></pre></td></tr></table></figure></li></ul><p>&emsp;&emsp;&emsp;<strong><a href="https://git-scm.com/book/zh/v2" target="_blank" rel="noopener">教程：Git - Book</a></strong></p><ul><li><h2 id="GitHub（去注册）"><a href="#GitHub（去注册）" class="headerlink" title="GitHub（去注册）"></a><em>GitHub</em>（<a href="https://github.com/join?source=header-home" target="_blank" rel="noopener">去注册</a>）</h2><h3 id="关联Git和GitHub"><a href="#关联Git和GitHub" class="headerlink" title="关联Git和GitHub"></a>关联Git和GitHub</h3>生成SSH密匙 输入下面命令后，一路回车即可<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-keygen -t rsa -C &quot;你的邮箱地址&quot;</span><br></pre></td></tr></table></figure></li></ul><p>&emsp;&emsp;&emsp;<strong><a href="https://github.com/settings/keys" target="_blank" rel="noopener">GitHub 配置SSH Key</a></strong></p><ul><li><h2 id="创建一个仓库做GitHub-Pages（What-is-GitHub-Pages-）"><a href="#创建一个仓库做GitHub-Pages（What-is-GitHub-Pages-）" class="headerlink" title="创建一个仓库做GitHub Pages（What is GitHub Pages?）"></a><em>创建一个仓库做GitHub Pages（<a href="https://help.github.com/articles/what-is-github-pages/" target="_blank" rel="noopener">What is GitHub Pages?</a>）</em></h2><h2 id="Note："><a href="#Note：" class="headerlink" title="Note："></a>Note：</h2>&emsp;&emsp;<span class="note"><em>1.第一次需要验证邮箱</em><br>&emsp;&emsp;<em>2.仓库名称固定格式为： 你的GitHub用户名.github.io</em></span><h3 id="创建成功后，现在可以访问你的GitHub-Pages了"><a href="#创建成功后，现在可以访问你的GitHub-Pages了" class="headerlink" title="创建成功后，现在可以访问你的GitHub Pages了"></a>创建成功后，现在可以访问你的GitHub Pages了</h3><img src="/images/hexo-github-pages/call-github-pages.png" alt="call-github-pages.png"></li></ul><blockquote><h2 id="安装Hexo"><a href="#安装Hexo" class="headerlink" title="安装Hexo"></a>安装Hexo</h2></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install -g hexo</span><br></pre></td></tr></table></figure><h3 id="查看版本"><a href="#查看版本" class="headerlink" title="查看版本"></a>查看版本</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo -v</span><br></pre></td></tr></table></figure><p><img src="/images/hexo-github-pages/see-hexo-version.png" alt="see-hexo-version.png"></p><h3 id="创建Hexo目录"><a href="#创建Hexo目录" class="headerlink" title="创建Hexo目录"></a>创建Hexo目录</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mkdir Hexo</span><br></pre></td></tr></table></figure><h3 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo init [目录名] 或进入目录执行命令 $ hexo init</span><br></pre></td></tr></table></figure><p><img src="/images/hexo-github-pages/hexo-init.png" alt="hexo-init.png"></p><h3 id="Hexo会自动在这个目录下建立需要的文件夹和文件（目录介绍）"><a href="#Hexo会自动在这个目录下建立需要的文件夹和文件（目录介绍）" class="headerlink" title="Hexo会自动在这个目录下建立需要的文件夹和文件（目录介绍）"></a>Hexo会自动在这个目录下建立需要的文件夹和文件（<a href="https://hexo.io/zh-cn/docs/setup.html" target="_blank" rel="noopener">目录介绍</a>）</h3><p><img src="/images/hexo-github-pages/hexo-dir.png" alt="hexo-dir.png"></p><h3 id="安装依赖"><a href="#安装依赖" class="headerlink" title="安装依赖"></a>安装依赖</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install</span><br></pre></td></tr></table></figure><p><img src="/images/hexo-github-pages/npm-install.png" alt="npm-install.png"></p><blockquote><h2 id="本地预览"><a href="#本地预览" class="headerlink" title="本地预览"></a>本地预览</h2></blockquote><h3 id="生成静态页面和资源文件"><a href="#生成静态页面和资源文件" class="headerlink" title="生成静态页面和资源文件"></a>生成静态页面和资源文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate简写：hexo g</span><br></pre></td></tr></table></figure><h3 id="启动服务"><a href="#启动服务" class="headerlink" title="启动服务"></a>启动服务</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server简写：hexo s</span><br></pre></td></tr></table></figure><h3 id="命令可以组合使用-启动服务并生成资源文件"><a href="#命令可以组合使用-启动服务并生成资源文件" class="headerlink" title="命令可以组合使用,启动服务并生成资源文件"></a>命令可以组合使用,启动服务并生成资源文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo s -g</span><br></pre></td></tr></table></figure><p><strong><a href="https://hexo.io/zh-cn/docs/index.html" target="_blank" rel="noopener">更多命令查看Hexo文档</a></strong></p><h3 id="现在你可以通过-http-localhost-4000-进行访问了"><a href="#现在你可以通过-http-localhost-4000-进行访问了" class="headerlink" title="现在你可以通过 http://localhost:4000/ 进行访问了"></a>现在你可以通过 <code>http://localhost:4000/</code> 进行访问了</h3><p><img src="/images/hexo-github-pages/hexo-index.png" alt="hexo-index.png"></p><blockquote><h2 id="部署至GitHub"><a href="#部署至GitHub" class="headerlink" title="部署至GitHub"></a>部署至GitHub</h2></blockquote><h3 id="修改Hexo根目录下的-config-yml-主站配置文件中的-deploy-参数："><a href="#修改Hexo根目录下的-config-yml-主站配置文件中的-deploy-参数：" class="headerlink" title="修改Hexo根目录下的 _config.yml 主站配置文件中的 deploy 参数："></a>修改Hexo根目录下的 <code>_config.yml</code> 主站配置文件中的 <code>deploy</code> 参数：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">deploy:</span><br><span class="line">   type: git</span><br><span class="line">   repo: &lt;仓库地址&gt;</span><br><span class="line">   branch: [分支名称]</span><br><span class="line">   message: [提交信息]</span><br></pre></td></tr></table></figure><h3 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy 简写： hexo d</span><br></pre></td></tr></table></figure><p><img src="/images/hexo-github-pages/hexo-d.png" alt="hexo-d.png"></p><h3 id="Note"><a href="#Note" class="headerlink" title="Note:"></a>Note:</h3><p>&emsp;&emsp;<span class="note"><em>部署提示找不到：git<br>&emsp;&emsp;3.0 后 type需改为 git ，deploy部分被单独出来了，需要单独安装</em></span></p><h2 id="安装-hexo-deployer-git"><a href="#安装-hexo-deployer-git" class="headerlink" title="安装 hexo-deployer-git"></a>安装 hexo-deployer-git</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure><h2 id="执行-hexo-d-，部署成功后开始访问你的博客吧！"><a href="#执行-hexo-d-，部署成功后开始访问你的博客吧！" class="headerlink" title="执行 hexo d ，部署成功后开始访问你的博客吧！"></a>执行 <code>hexo d</code> ，部署成功后开始访问你的博客吧！</h2><p><img src="/images/hexo-github-pages/github-pages-index.png" alt="github-pages-index.png"></p><h1 id="（完）"><a href="#（完）" class="headerlink" title="（完）"></a>（完）</h1>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;h2 id=&quot;准备工具&quot;&gt;&lt;a href=&quot;#准备工具&quot; class=&quot;headerlink&quot; title=&quot;准备工具&quot;&gt;&lt;/a&gt;准备工具&lt;/h2&gt;&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;Node.js（必须）用于支持Hexo，生成静态页面&lt;/l
      
    
    </summary>
    
    
      <category term="Hexo" scheme="zzhangffan.com/tags/Hexo/"/>
    
  </entry>
  
</feed>
